<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KIỂM TRA TƯƠNG TÁC ALKENE-ALKYNE</title>
    <style>
        body { background-color: #ffc0cb; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        #header-frame { background-color: #ffff00; padding: 20px; border-radius: 10px; border: 3px solid #0000ff; margin-bottom: 20px; width: 80%; max-width: 800px; text-align: center; }
        h1 { color: #0000ff; margin: 0; text-transform: uppercase; font-size: 24px; }
        .container { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); width: 100%; max-width: 600px; }
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"] { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { background-color: #0000ff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-size: 16px; margin-top: 10px; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        .hidden { display: none; }
        .question-box { margin-bottom: 20px; }
        .options { list-style: none; padding: 0; }
        .options li { margin: 10px 0; padding: 10px; border: 1px solid #eee; border-radius: 4px; cursor: pointer; transition: background 0.2s; }
        .options li:hover { background: #f0f0f0; }
        .options li.selected { background: #d1d1ff; border-color: #0000ff; }
        .result-box { text-align: center; }
        .review-item { text-align: left; border-bottom: 1px solid #eee; padding: 10px 0; }
        .correct-text { color: green; font-weight: bold; }
        .wrong-text { color: red; font-weight: bold; }
        sub { vertical-align: sub; font-size: smaller; }
    </style>
</head>
<body>

<div id="header-frame">
    <h1>KIỂM TRA TƯƠNG TÁC ALKENE-ALKYNE</h1>
</div>

<div id="login-screen" class="container">
    <div class="input-group">
        <label>Họ và Tên:</label>
        <input type="text" id="studentName" placeholder="Nhập họ tên...">
    </div>
    <div class="input-group">
        <label>Lớp:</label>
        <input type="text" id="studentClass" placeholder="Nhập lớp...">
    </div>
    <button id="startBtn" disabled>Làm bài</button>
</div>

<div id="quiz-screen" class="container hidden">
    <div id="question-container"></div>
    <button id="nextBtn" class="hidden">Câu tiếp theo</button>
    <button id="submitBtn" class="hidden">Nộp bài</button>
</div>

<div id="result-screen" class="container hidden">
    <div class="result-box">
        <h2>KẾT QUẢ</h2>
        <p id="scoreText"></p>
        <p id="statsText"></p>
        <button id="reviewBtn">Xem lại kết quả</button>
        <button id="restartBtn">Làm lại bài</button>
    </div>
</div>

<div id="review-screen" class="container hidden" style="max-width: 800px;">
    <h2>CHI TIẾT BÀI LÀM</h2>
    <div id="review-list"></div>
    <button id="backToResultBtn">Quay lại</button>
</div>

<script>
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxVGSFgSX-cmBr6vYmsIJ4oEiW9-DRsh9znTa1xyWInc0ol33pdPek1aJjqNEhYnF_E/exec";

    const questionsData = [
        { q: "Hydrocarbon không no là những hydrocarbon trong phân tử có chứa", o: ["liên kết đơn.", "liên kết σ.", "liên kết bội.", "vòng benzene."], a: "liên kết bội." },
        { q: "Công thức tổng quát của các alkene là", o: ["C<sub>n</sub>H<sub>2n+2</sub> (n ≥ 2).", "C<sub>n</sub>H<sub>2n</sub> (n ≥ 2).", "C<sub>n</sub>H<sub>2n-2</sub> (n ≥ 2).", "C<sub>2n</sub>H<sub>n</sub> (n ≥ 2)."], a: "C<sub>n</sub>H<sub>2n</sub> (n ≥ 2)." },
        { q: "Công thức tổng quát của alkyne là", o: ["C<sub>n</sub>H<sub>2n+2</sub> (n ≥ 2).", "C<sub>n</sub>H<sub>2n</sub> (n ≥ 2).", "C<sub>n</sub>H<sub>2n-2</sub> (n ≥ 2).", "C<sub>2n</sub>H<sub>n</sub> (n ≥ 2)."], a: "C<sub>n</sub>H<sub>2n-2</sub> (n ≥ 2)." },
        { q: "Ethylene (ethene) có công thức phân tử là", o: ["CH<sub>4</sub>.", "C<sub>2</sub>H<sub>4</sub>.", "C<sub>2</sub>H<sub>2</sub>.", "C<sub>3</sub>H<sub>6</sub>."], a: "C<sub>2</sub>H<sub>4</sub>." },
        { q: "Acetylene (ethyne) có công thức phân tử là", o: ["CH<sub>4</sub>.", "C<sub>2</sub>H<sub>4</sub>.", "C<sub>2</sub>H<sub>2</sub>.", "C<sub>3</sub>H<sub>6</sub>."], a: "C<sub>2</sub>H<sub>2</sub>." },
        { q: "Chất nào sau đây là alkene?", o: ["CH<sub>3</sub>−CH<sub>2</sub>−CH<sub>3</sub>.", "CH<sub>2</sub>=CH−CH<sub>3</sub>.", "CH≡C−CH<sub>3</sub>.", "CH≡CH."], a: "CH<sub>2</sub>=CH−CH<sub>3</sub>." },
        { q: "Hợp chất nào sau đây là một alkyne?", o: ["CH<sub>3</sub>CH<sub>2</sub>CH<sub>2</sub>CH<sub>3</sub>.", "CH<sub>3</sub>CH=CH<sub>2</sub>.", "CH<sub>3</sub>CH<sub>2</sub>C≡CH.", "CH<sub>2</sub>=CH-CH=CH<sub>2</sub>."], a: "CH<sub>3</sub>CH<sub>2</sub>C≡CH." },
        { q: "Tổng số liên kết σ trong phân tử alkene C<sub>4</sub>H<sub>8</sub> là", o: ["8.", "11.", "12.", "4."], a: "11." },
        { q: "Alkyne C<sub>4</sub>H<sub>6</sub> có số đồng phân cấu tạo là", o: ["1.", "2.", "3.", "4."], a: "2." },
        { q: "Chất nào dưới đây có đồng phân cis−trans?", o: ["CH<sub>2</sub>=CH−CH<sub>3</sub>.", "CH<sub>3</sub>−CH=CH−CH<sub>3</sub>.", "(CH<sub>3</sub>)<sub>2</sub>C=CH−CH<sub>3</sub>.", "CH<sub>3</sub>−C≡C−CH<sub>3</sub>."], a: "CH<sub>3</sub>−CH=CH−CH<sub>3</sub>." },
        { q: "Cho các chất sau: 2-methylbut-1-ene (1); 3,3-dimethylbut-1-ene (2); 3-methylpent-1-ene (3); 3-methylpent-2-ene (4). Những chất nào là đồng phân của nhau?", o: ["(3) và (4).", "(1),(2) và (3).", "(1) và (2).", "(2), (3) và (4)."], a: "(2), (3) và (4)." },
        { q: "[HH.1.3 – Vận dụng] Chất X có công thức: CH<sub>3</sub>−CH(CH<sub>3</sub>)−CH=CH<sub>2</sub>. Tên thay thế của X là", o: ["3-ethylbut-1-ene.", "3-methylbut-1-ene.", "2-methylbut-3-ene.", "2-methylbut-3-yne."], a: "3-methylbut-1-ene." },
        { q: "Alkene X có công thức cấu tạo: CH<sub>3</sub>– CH<sub>2</sub>– C(CH<sub>3</sub>)=CH–CH<sub>3</sub>. Tên của X là", o: ["isohexane.", "3-methylpent-3-ene.", "3-methylpent-2-ene.", "2-ethylbut-2-ene."], a: "3-methylpent-2-ene." },
        { q: "Cho Alkyne X có CTCT sau: CH<sub>3</sub>−C≡C−CH(CH<sub>3</sub>)−CH<sub>3</sub>. Tên thay thế của X là", o: ["4-methylpent-2-yne.", "2-methylpent-3-yne.", "4-methylpent-3-yne.", "2-methylpent-4-yne."], a: "4-methylpent-2-yne." },
        { q: "Alkyne X có công thức cấu tạo như sau: CH<sub>3</sub>-CH<sub>2</sub>-C(CH<sub>3</sub>)<sub>2</sub>-C≡C-CH<sub>3</sub>. Tên gọi của X theo danh pháp thay thế là", o: ["4-ethyl-4-methylpent-2-yne.", "4,4-dimethylhex-2-yne.", "3,3-dimethylhex-4-yne.", "2-ethyl-2-methylpent-3-yne."], a: "4,4-dimethylhex-2-yne." },
        { q: "Cho phản ứng CH<sub>3</sub>−CH=CH−CH<sub>3</sub> + H<sub>2</sub> → X. Tên gọi của X là", o: ["butene.", "butane.", "isobutane.", "2-methylpropane."], a: "butane." },
        { q: "Ở điều kiện thường, chất nào sau đây làm mất màu dung dịch Br<sub>2</sub>?", o: ["Methane.", "Butane.", "Propene.", "Ethane."], a: "Propene." },
        { q: "Khi cho but-1-ene tham gia phản ứng cộng với HBr, sản phẩm chính thu được theo quy tắc Markovnikov có tên gọi là", o: ["1-bromobutane.", "2-bromobutane.", "1,2-dibromboutane.", "1,4-dibromobutane."], a: "2-bromobutane." },
        { q: "Chất nào sau đây khi tác dụng với H<sub>2</sub>O (H<sub>2</sub>SO<sub>4</sub>, t<sup>o</sup>) thu được ethyl alcohol?", o: ["ethane.", "propane.", "ethene.", "propene."], a: "ethene." },
        { q: "Cho propyne tác dụng hoàn toàn với H<sub>2</sub> dư (xt Ni, t<sup>o</sup>) thu được sản phẩm có công thức là", o: ["CH<sub>2</sub>=CH<sub>2</sub>.", "CH<sub>3</sub>−CH<sub>2</sub>−CH<sub>3</sub>.", "CH<sub>3</sub>−CH<sub>3</sub>.", "CH<sub>2</sub>=CH−CH<sub>3</sub>."], a: "CH<sub>3</sub>−CH<sub>2</sub>−CH<sub>3</sub>." },
        { q: "Hydrocarbon nào dưới đây có thể tham gia phản ứng trùng hợp tạo polymer?", o: ["CH<sub>3</sub>−CH<sub>3</sub>.", "CH<sub>2</sub>=CH−CH<sub>3</sub>.", "CH<sub>3</sub>−CH<sub>2</sub>−CH<sub>3</sub>.", "CH<sub>3</sub>−CH(CH<sub>3</sub>)<sub>2</sub>."], a: "CH<sub>2</sub>=CH−CH<sub>3</sub>." },
        { q: "Trùng hợp ethene thu được polymer có tên gọi là", o: ["polypropylene.", "polyethene.", "polystyrene.", "poly(vinyl chloride)."], a: "polyethene." },
        { q: "Cho các chất có công thức cấu tạo như sau: (1) CH≡C–COOH; (2) CH≡C–CH=CH<sub>2</sub>; (3) CH≡C–CH<sub>2</sub>–CH<sub>2</sub>–C≡CH; (4) CH<sub>3</sub>–C≡C–CH<sub>2</sub>–CH<sub>3</sub>. Số chất có khả năng tham gia phản ứng với dung dịch AgNO<sub>3</sub> trong NH<sub>3</sub> là", o: ["2.", "3.", "4.", "1."], a: "3." },
        { q: "Để phân biệt but-1-yne và but-2-yne người ta dùng thuốc thử sau đây?", o: ["Dung dịch KMnO<sub>4</sub>/H<sub>2</sub>SO<sub>4</sub>.", "Dung dịch AgNO<sub>3</sub> trong NH<sub>3</sub>.", "Dung dịch Br<sub>2</sub>.", "Dung dịch H<sub>2</sub>SO<sub>4</sub>, HgSO<sub>4</sub>."], a: "Dung dịch AgNO<sub>3</sub> trong NH<sub>3</sub>." },
        { q: "Ứng dụng nào không phải của alkene?", o: ["Dung để sản xuất keo dán, chất dẻo.", "Dùng để sản xuất acid hữu cơ, nguyên liệu cho công nghiệp hóa học.", "Dùng làm dung môi, sản xuất polymer.", "Dùng làm nhiên liệu động cơ."], a: "Dùng làm nhiên liệu động cơ." }
    ];

    let currentQuestions = [];
    let currentIndex = 0;
    let userAnswers = [];

    const nameInput = document.getElementById('studentName');
    const classInput = document.getElementById('studentClass');
    const startBtn = document.getElementById('startBtn');
    const quizScreen = document.getElementById('quiz-screen');
    const loginScreen = document.getElementById('login-screen');
    const questionContainer = document.getElementById('question-container');
    const nextBtn = document.getElementById('nextBtn');
    const submitBtn = document.getElementById('submitBtn');
    const resultScreen = document.getElementById('result-screen');
    const scoreText = document.getElementById('scoreText');
    const statsText = document.getElementById('statsText');
    const reviewBtn = document.getElementById('reviewBtn');
    const restartBtn = document.getElementById('restartBtn');
    const reviewScreen = document.getElementById('review-screen');
    const reviewList = document.getElementById('review-list');
    const backToResultBtn = document.getElementById('backToResultBtn');

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function checkInputs() {
        startBtn.disabled = !(nameInput.value.trim() && classInput.value.trim());
    }

    nameInput.addEventListener('input', checkInputs);
    classInput.addEventListener('input', checkInputs);

    startBtn.addEventListener('click', () => {
        currentQuestions = shuffle([...questionsData]).map(q => {
            const options = shuffle([...q.o]);
            return { ...q, options };
        });
        currentIndex = 0;
        userAnswers = new Array(25).fill(null);
        loginScreen.classList.add('hidden');
        quizScreen.classList.remove('hidden');
        showQuestion();
    });

    function showQuestion() {
        const q = currentQuestions[currentIndex];
        questionContainer.innerHTML = `
            <h3>Câu ${currentIndex + 1}: ${q.q}</h3>
            <ul class="options">
                ${q.options.map((opt, i) => `<li onclick="selectOption(${i})">${opt}</li>`).join('')}
            </ul>
        `;
        nextBtn.classList.add('hidden');
        submitBtn.classList.add('hidden');
    }

    window.selectOption = (optionIndex) => {
        const options = document.querySelectorAll('.options li');
        options.forEach(li => li.classList.remove('selected'));
        options[optionIndex].classList.add('selected');
        userAnswers[currentIndex] = currentQuestions[currentIndex].options[optionIndex];

        if (currentIndex < 24) {
            nextBtn.classList.remove('hidden');
        } else {
            submitBtn.classList.remove('hidden');
        }
    };

    nextBtn.addEventListener('click', () => {
        currentIndex++;
        showQuestion();
    });

    submitBtn.addEventListener('click', async () => {
        let correct = 0;
        let wrong = 0;
        let unanswered = 0;

        currentQuestions.forEach((q, i) => {
            if (userAnswers[i] === null) unanswered++;
            else if (userAnswers[i] === q.a) correct++;
            else wrong++;
        });

        const score = (correct * 0.4).toFixed(1);

        quizScreen.classList.add('hidden');
        resultScreen.classList.remove('hidden');
        scoreText.innerText = `Điểm của bạn: ${score}/10`;
        statsText.innerText = `Đúng: ${correct} | Sai: ${wrong} | Chưa làm: ${unanswered}`;

        const payload = {
            name: nameInput.value,
            class: classInput.value,
            score: score,
            correct: correct,
            wrong: wrong,
            unanswered: unanswered,
            total: 25
        };

        if (WEB_APP_URL !== "YOUR_APPS_SCRIPT_URL_HERE") {
            try {
                await fetch(WEB_APP_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    cache: 'no-cache',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
            } catch (e) { console.error(e); }
        }
    });

    reviewBtn.addEventListener('click', () => {
        resultScreen.classList.add('hidden');
        reviewScreen.classList.remove('hidden');
        reviewList.innerHTML = currentQuestions.map((q, i) => {
            const userAns = userAnswers[i];
            const isCorrect = userAns === q.a;
            return `
                <div class="review-item">
                    <p><strong>Câu ${i + 1}:</strong> ${q.q}</p>
                    <p>Đáp án của bạn: <span class="${isCorrect ? 'correct-text' : 'wrong-text'}">${userAns || 'Chưa làm'}</span></p>
                    ${!isCorrect ? `<p>Đáp án đúng: <span class="correct-text">${q.a}</span></p>` : ''}
                </div>
            `;
        }).join('');
    });

    backToResultBtn.addEventListener('click', () => {
        reviewScreen.classList.add('hidden');
        resultScreen.classList.remove('hidden');
    });

    restartBtn.addEventListener('click', () => {
        resultScreen.classList.add('hidden');
        loginScreen.classList.remove('hidden');
        nameInput.value = '';
        classInput.value = '';
        checkInputs();
    });
</script>

</body>
</html>